

	Sentencias SQL Utilizadas

	consolidado
	Obtencion de datos de factura principal 
SELECT fp.EMPRESA, fp.VENDEDOR (COD), fp.CODIGO_CLIENTE, 
fp.FECHA_FACTURA, fp.VALOR_FACTURA, fp.VALOR_TOTAL_PAGADO (WISHHH),
clf.
FROM CLNT_FACTURA_PRINCIPAL fp, CLNT_FICHA_PRINCIPAL clf
WHERE 
ANULADO = false 




SELECT 
pfp.VENDOR_NAME AS Proveedor ,
TRIM(' DIAS' FROM pfp.`TERMS ALFA`) AS `Dias Credito`, 
pcu.`VEND INV REF` AS Factura, 
DATE_TO_CHAR(fp.INVOICE_DATE, 'dd[/]mm[/]yyyy') AS `Fecha factura`,
fp.`RETENTION BASIS`  AS Subtotal,
fp.`AMOUNT TAX2` AS `Total CR Tributario`, 
fp.INVOICE_TOTAL AS `Total Factura`, 
pcu.`PAYMENT AMOUNT` AS `Total Pagos`, 
pcu.`PAYMENT AMOUNT` AS `Total Ncprv\Ndprv`, 
pcu.`DISCOUNT AMOUNT` AS `Total Dcto Adicional`, 
pcu.`RETENTION AMNT` AS `Total Retenciones`, 
pcu.`AMOUNT DUE` AS `Saldos Actual`, 
pcu.`CHECK NUMBER` AS `No. Cheque`,
bfp.NOMBRE_BANCO AS Banco,
bmp.MEMO as Memo,
bmp.FECHA_PAGO as `Fecha Cheque`,
pfp.LOCALIZACION_PROVEEDOR as Localizacion
FROM PROV_Cobros_Cuotas pcu, PROV_Factura_Principal fp, PROV_Ficha_Principal pfp,
BANC_Movimientos_Principal bmp, BANC_FICHA_PRINCIPAL bfp
WHERE
pcu.`VEND INV REF` = fp.DOC_REFERENCE 
AND fp.VENDOR_ID_CORP = pfp.CODIGO_PROVEEDOR_EMPRESA 
AND (pcu.CORP = 'LABOV') 
AND fp.VOID = cast('False' as Boolean) 
AND fp.INVOICE_DATE >= '01/06/2018' 
AND fp.INVOICE_DATE <= '23/10/2018'
AND pcu.`CHECK ID CORP`= bmp.CODIGO_MOVIMIENTO_EMPRESA
AND (bfp.CODIGO_BANCO_EMPRESA = bmp.CODIGO_BANCO_EMPRESA)

SELECT 
DATE_TO_CHAR(FP.FECHA_FACTURA, 'dd[/]mm[/]yyyy') AS `FECHA FACTURA`,
SUBSTRING(CCD.CODIGO_FACTURA,1,17) as  `FACTURA`, 
CCD.CODIGO_COBRO,
CFP.NOMBRE_CLIENTE `CLIENTE`,
DATE_TO_CHAR(CCP.FECHA_COBRO, 'dd[/]mm[/]yyyy') AS `FECHA PAGO`,
DATE_TO_CHAR(CCP.FECHA_COBRO, 'dd[/]mm[/]yyyy') AS `FECHA DOCUMENTO`,
DATE_TO_CHAR(FP.FECHA_VENCIMIENTO, 'dd[/]mm[/]yyyy') AS `FECHA VENCIMIENTO` ,
CCP.VALOR_COBRO `VALOR COBRO`, 
CCP.CHEQUE_NUMERO `NUMERO CHEQUE`,
CCD.ID_FISCAL `CUENTA BANCARIA`,
CBFP.FECHA_CHEQUE_O_EXPIRA_TC `FECHA CHEQUE`,
CBP.FORMA_DE_PAGO `FORMA DE PAGO`,
CCP.CODIGO_COBRADOR `CODIGO COBRADOR`
FROM 
CLNT_FICHA_PRINCIPAL CFP, 
CLNT_COBRO_DETALLE CCD,
CLNT_COBRO_PRINCIPAL CCP,
CLNT_FACTURA_PRINCIPAL FP,
CLNT_COBRO_FORMADEPAGO CBFP
WHERE 
CCD.CODIGO_COBRO = CCP.CODIGO_COBRO AND
CFP.CODIGO_CLIENTE_EMPRESA = CCD.CODIGO_CLIENTE AND
CCD.CODIGO_FACTURA = FP.CODIGO_FACTURA
CBFP.CODIGO_COBRO = CCD.CODIGO_COBRO
